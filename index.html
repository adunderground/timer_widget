<!-- 

  TODO 
 -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Timer</title>
    <link href="https://fonts.googleapis.com/css2?family=Philosopher&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Oswald&display=swap" rel="stylesheet">
    <style>
      /* fonts */
      @import url('https://fonts.googleapis.com/css2?family=Josefin+Sans&display=swap');
      @import url('https://fonts.googleapis.com/css2?family=Inter&display=swap');

      /*css reset*/
      html,
      body,
      div,
      span,
      applet,
      object,
      iframe,
      h1,
      h2,
      h3,
      h4,
      h5,
      h6,
      p,
      blockquote,
      pre,
      a,
      abbr,
      acronym,
      address,
      big,
      cite,
      code,
      del,
      dfn,
      em,
      img,
      ins,
      kbd,
      q,
      s,
      samp,
      small,
      strike,
      strong,
      sub,
      sup,
      tt,
      var,
      b,
      u,
      i,
      center,
      dl,
      dt,
      dd,
      ol,
      ul,
      li,
      fieldset,
      form,
      label,
      legend,
      table,
      caption,
      tbody,
      tfoot,
      thead,
      tr,
      th,
      td,
      article,
      aside,
      canvas,
      details,
      embed,
      figure,
      figcaption,
      footer,
      header,
      hgroup,
      menu,
      nav,
      output,
      ruby,
      section,
      summary,
      time,
      mark,
      audio,
      video {
        margin: 0;
        padding: 0;
        border: 0;
        font-size: 100%;
        font: inherit;
        vertical-align: baseline;
      }
      /* HTML5 display-role reset for older browsers */
      article,
      aside,
      details,
      figcaption,
      figure,
      footer,
      header,
      hgroup,
      menu,
      nav,
      section {
        display: block;
      }
      body {
        line-height: 1;
      }
      ol,
      ul {
        list-style: none;
      }
      blockquote,
      q {
        quotes: none;
      }
      blockquote:before,
      blockquote:after,
      q:before,
      q:after {
        content: '';
        content: none;
      }
      table {
        border-collapse: collapse;
        border-spacing: 0;
      }
      * {
        box-sizing: border-box;
      }
      /* END CSS RESET */

      /*main styles*/
      html,
      body {
        width: 100%;
        height: 100%;
      }

      main {
        background: #ff6f4c;
        color: #fff;
        /* font-family: 'Philosopher', sans-serif; */
        font-family: 'Josefin Sans', sans-serif;
        /* font-family: 'Inter', sans-serif; */
        padding: 5rem 10rem;
        height: 100vh;
        width: 100%;
        display: flex;
        flex-flow: column nowrap;
        justify-content: flex-start;
        align-items: stretch;
        transition: background 2s linear;
      }

      #title {
        font-size: 5rem;
        text-align: center;
        font-family: 'Josefin Sans', sans-serif;
      }

      #bar {
        width: 100%;
        height: 10px;
        background: #fff;
        margin-top: 1rem;
      }

      /* clock styling */

      #timer {
        flex: 1;
        display: flex;
        flex-flow: row wrap;
        justify-content: space-between;
        align-content: space-between;
        margin: 5rem 0;
      }

      #timer > div {
        display: flex;
        flex-flow: column nowrap;
        justify-content: flex-start;
        align-items: center;
      }

      /* div wrapper for svg */
      #timer .svgclock {
        width: 200px;
      }

      #timer svg {
        overflow: visible;
      }

      /* border only */
      #timer circle {
        fill: transparent;
        stroke-width: 0.01;
        stroke: #fff; /*#ef8c59*/
      }

      /* actual svg circle */
      #timer .clock {
        fill: url(#clockgradient); /*#ef8c59; */
        stroke: #fff;
        stroke-width: 0.03;
        transform: scale(1, -1);
      }

      #timer .time {
        font-family: 'Inter', sans-serif !important;
        font-size: 0.5px;
        text-shadow: 0px 0px 6px #999;
        text-anchor: middle;
        fill: #fff;
        font-family: 'oswald';
      }

      /* timer headers */
      #timer .title {
        font-family: 'Inter', sans-serif !important;
        margin-top: 1rem;
        font-size: 2.5rem;
        font-weight: 400;
      }

      /*BREAKPOINTS START HERE*/

      @media (max-width: 480px) {
      }
      @media (max-width: 768px) {
      }
    </style>
    <script>
      window.onload = function () {
        let [daysLeft, hoursLeft, minutesLeft, secondsLeft] = calculateTime();

        window.daysX = new Clock('days', (units = 365), (startVal = daysLeft));
        window.hoursX = new Clock('hours', (units = 24), (startVal = hoursLeft), (parent = 'daysX'));
        window.minutesX = new Clock('minutes', (units = 60), (startVal = minutesLeft), (parent = 'hoursX'));
        window.secondsX = new Clock('seconds', (units = 60), (startVal = secondsLeft), (parent = 'minutesX'));

        setInterval(function () {
          updateClocks();
        }, 100);
        setInterval(changeBG, 1000 * 15);
      };

      function Clock(name, units, startVal, parent = null) {
        this.clock_name = name;
        this.el = document.querySelector(`#${name}`);
        this.clock = document.querySelector(`#${name} .clock`);
        this.counter = document.querySelector(`#${name} .time`);
        this.units = units;
        this.degrees = 360 / units;
        this.angle = startVal ? (startVal / units) * 360 : 0;
        this.parent = parent;

        // set initial prercentage
        let flip = this.angle > 180 ? 1 : 0;
        let [x, y] = getCoords(this.angle);
        let d = `
				    M 0 0,
				    V 1,
				    A 1 1 0 ${flip} 0 ${x} ${y},
				    z
				  `;
        this.clock.setAttribute('d', d);
        this.counter.textContent = `${startVal}`;
      }

      Clock.prototype.update = function (newVal, precision = null) {
        // only for seconds clock - adds millisecond precision
        if (precision && this.clock_name == 'seconds') {
          newVal = newVal + precision / 1000;
        }

        this.angle = (newVal / this.units) * 360;
        let flip = this.angle > 180 ? 1 : 0;
        let [x, y] = getCoords(this.angle);
        let d = `
				    M 0 0,
				    V 1,
				    A 1 1 0 ${flip} 0 ${x} ${y},
				    z
				  `;
        this.clock.setAttribute('d', d);
        this.counter.textContent = `${parseInt(newVal)}`;
      };

      // gives (x,y) coords for circle sector
      function getCoords(deg) {
        let x = Math.sin(toRadian(deg));
        let y = Math.cos(toRadian(deg));
        return [x, y];
      }

      // converts degrees to radians
      function toRadian(deg) {
        return (deg * Math.PI) / 180;
      }

      // calculate countdown time
      function calculateTime() {
        const start = new Date().getTime();
        const end = new Date(END_DATE).getTime();
        let timeLeft = parseInt((end - start) / 1000);
        let timeLeftMS = parseInt(end - start);

        if (timeLeft >= 0) {
          var daysLeft = parseInt(timeLeft / 86400);
          timeLeft = timeLeft % 86400;

          var hoursLeft = parseInt(timeLeft / 3600);
          timeLeft = timeLeft % 3600;

          var minutesLeft = parseInt(timeLeft / 60);
          timeLeft = timeLeft % 60;

          var secondsLeft = parseInt(timeLeft);
          var millisecondsLeft = timeLeftMS % 1000;
        }

        return [daysLeft, hoursLeft, minutesLeft, secondsLeft, millisecondsLeft];
      }

      // set each clock to new time
      function updateClocks() {
        // calculate remaining time
        let [daysLeft, hoursLeft, minutesLeft, secondsLeft, millisecondsLeft] = calculateTime();

        // check if its empty
        if (!daysLeft && !hoursLeft && !minutesLeft && !secondsLeft) {
          document.getElementById('timer').innerHTML = `
				<div style="font-size: 6em;">${END_MESSAGE}</div>
				`;
        }

        window.daysX.update(daysLeft);
        window.hoursX.update(hoursLeft);
        window.minutesX.update(minutesLeft);
        window.secondsX.update(secondsLeft, millisecondsLeft);
      }

      function changeBG() {
        const bg = document.querySelector('main');
        let current = bg.style.background;

        let i = Math.floor(Math.random() * 6);

        while (i == colors.indexOf(current)) {
          i = Math.floor(Math.random() * 6);
        }
        // change BG and clock fill
        bg.style.background = colors[i].solid;
        var clockColors = document.querySelectorAll('radialGradient stop');
        clockColors[0].style.stopColor = colors[i].g1;
        clockColors[1].style.stopColor = colors[i].g2;
      }

      const colors = [
        { solid: '#ff6f4c', g1: '#ff6f4c', g2: 'ef8c59' },
        { solid: '#B2ACA6', g1: '#B2ACA6', g2: '#b8c0c7' },
        { solid: '#4B6771', g1: '#4B6771', g2: '#608390' },
        { solid: '#9AA5AF', g1: '#9AA5AF', g2: '#b8c0c7' },
        { solid: '#7271C8', g1: '#7271C8', g2: '#9695d6' },
        { solid: '#035476', g1: '#035476', g2: '#0478a9' },
      ];

      //
      // CONFIGURATION: Please configure END_DATE and END_MESSAGE sections below:
      //
      // Place your desired date in the END_DATE variable below, between the quotation marks
      // Date should be in the format MM/DD/YYYY
      //
      // ▼ ▼ ▼ ▼ ▼ ▼ ▼ ▼
      const END_DATE = '1/1/2021';
      // ▲ ▲ ▲ ▲ ▲ ▲ ▲ ▲
      //
      //
      // ▼ ▼ ▼ ▼ ▼ ▼ ▼ ▼
      const END_MESSAGE = `
		Congrats! Our countdown has been reached!

		Thanks to everyone for a great year!
		`;
      // ▲ ▲ ▲ ▲ ▲ ▲ ▲ ▲
      //
    </script>
  </head>
  <body>
    <main>
      <h1 id="title">Countdown Timer</h1>
      <div id="bar"></div>
      <div id="timer">
        <div id="days">
          <div class="svgclock">
            <svg viewBox="-1 -1 2 2">
              <defs>
                <radialGradient id="clockgradient">
                  <stop offset="20%" style="stop-color: #ff6f4c;"></stop>
                  <stop offset="100%" style="stop-color: #ef8c59;"></stop>
                </radialGradient>
              </defs>
              <circle cx="0" cy="0" r="1" />
              <path
                class="clock"
                shape-rendering="geometricPrecision"
                d="M 0 0,
					         V 1,
					         A 1 1 0 1 0 -.001 1,
					         z
					         "
              />
              <text x="0" y="0.15" class="time">180</text>
            </svg>
          </div>
          <div class="title">Days</div>
        </div>
        <div id="hours">
          <div class="svgclock">
            <svg viewBox="-1 -1 2 2">
              <circle cx="0" cy="0" r="1" />
              <path
                class="clock"
                shape-rendering="geometricPrecision"
                d="M 0 0,
					         V 1,
					         A 1 1 0 1 0 -.001 1,
					         z
					         "
              />
              <text x="0" y="0.15" class="time">24</text>
            </svg>
          </div>
          <div class="title">Hours</div>
        </div>
        <div id="minutes">
          <div class="svgclock">
            <svg viewBox="-1 -1 2 2">
              <circle cx="0" cy="0" r="1" />
              <path
                class="clock"
                shape-rendering="geometricPrecision"
                d="M 0 0,
					         V 1,
					         A 1 1 0 1 0 -.001 1,
					         z
					         "
              />
              <text x="0" y="0.15" class="time">60</text>
            </svg>
          </div>
          <div class="title">Minutes</div>
        </div>
        <div id="seconds">
          <div class="svgclock">
            <svg viewBox="-1 -1 2 2">
              <circle cx="0" cy="0" r="1" />
              <path
                class="clock"
                shape-rendering="geometricPrecision"
                d="M 0 0,
					         V 1,
					         A 1 1 0 1 0 0 1,
					         z
					         "
              />
              <text x="0" y="0.15" class="time">60</text>
            </svg>
          </div>
          <div class="title">Seconds</div>
        </div>
      </div>
    </main>
  </body>
</html>
